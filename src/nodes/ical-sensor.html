<script type="text/javascript">
    { { icalEventsConfig } }
    { { icalEventsTimezones } }
    RED.nodes.registerType('ical-sensor', {
        category: 'ical',
        defaults: Object.assign(icalDefaults,
            {
                timeout: {
                    value: ""
                },
                timeoutUnits: {
                    value: ""
                },
                combineResponse: {}
            }),
        inputs: 1,
        outputs: 2,
        outputLabels: ["output on every tick", "output only on changes"],
        color: "#DEBD5C",
        label: function () {
            if (this.name) {
                return this.name;
            } else if (this.confignode.name) {
                return this.confignode.name;
            }

            return "event sensor";
        },
        icon: "font-awesome/fa-calendar",
        paletteLabel: "sensor",
        oneditprepare: function () {
            { { prepareIcalEvents } }
            $('#node-input-offset').parent().hide();
            $('#node-input-pastview').parent().hide();
            $('#node-input-preview').parent().hide();
            $('#node-input-checkall').parent().hide();

            $('#node-input-combineResponse').change(() => {
                var value = $('#node-input-combineResponse').prop('checked');
                if (value) {
                    $('#combine-response-hint').show();
                } else {
                    $('#combine-response-hint').hide();

                }
            });
        }
    })

</script>

<script type="text/html" id="icalSensor-template" data-template-name="ical-sensor">
    <!-- template.html -->
</script>

<script type="text/html" data-help-name="ical-sensor">
    <div class="form-row">
        <a href="https://naimo84.github.io/kalender-events/guide/sensors.html">
            <img src="https://img.shields.io/badge/doku-naimo84.github.io-0078D6?style=for-the-badge&logo=github&logoColor=white"/>
        </a>
    </div>
</script>
